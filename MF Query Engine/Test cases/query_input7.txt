SELECT ATTRIBUTE(S):
cust, prod, 1_avg_quant, 2_avg_quant
NUMBER OF GROUPING VARIABLES(n):
2
GROUPING ATTRIBUTES(V):
cust, prod
F-VECT([F]):
1_avg_quant, 2_avg_quant
SELECT CONDITION-VECT([Ïƒ]):
1.cust == cust and 1.prod == prod, 2.cust == cust and 2.prod != prod
HAVING_CONDITION(G):



<EMF>
<Standard SQL>

with t1 as (
	select x.cust, x.prod, avg(x.quant) t1_avg
	from sales x
	group by x.cust, x.prod
),
t2 as (
	select x.cust, x.prod, avg(y.quant) t2_avg
	from sales x, sales y
	where x.cust = y.cust and x.prod != y.prod
	group by x.cust, x.prod

)
select t1.cust, t1.prod, t1.t1_avg, t2.t2_avg
from t1, t2
where t1.cust = t2.cust and t1.prod = t2.prod
order by cust